```markdown
# ğŸ”¥ Home Assistant Heatmap Card - éœ€æ±‚è¯´æ˜æ–‡æ¡£

æœ¬é¡¹ç›®æ—¨åœ¨å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çš„ Home Assistant Lovelace å¡ç‰‡ï¼Œç”¨äºåœ¨èƒŒæ™¯å›¾ä¸Šæ¸²æŸ“åŸºäºä¼ æ„Ÿå™¨æ•°æ®çš„çƒ­åŠ›å›¾ã€‚æ”¯æŒä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼ŒåŒ…æ‹¬èƒŒæ™¯å›¾è®¾ç½®ã€çƒ­åŠ›ç‚¹ä½ç½®ä¸æ•°å€¼ã€åŠ¨æ€æ›´æ–°ã€é¢œè‰²æ¸å˜ã€å›¾ä¾‹ç­‰ã€‚

---

## âœ¨ åŠŸèƒ½æ€»è§ˆ

- ğŸ“· æ”¯æŒ PNG / JPG / SVG èƒŒæ™¯å›¾
- ğŸ”¥ åŸºäº heatmap.js çš„çƒ­åŠ›å›¾æ¸²æŸ“
- ğŸ§© å®æ—¶ç»‘å®š Home Assistant å®ä½“å€¼
- ğŸ” å¯é…ç½®è‡ªåŠ¨æ›´æ–°é¢‘ç‡ï¼ˆå•ä½ç§’ï¼‰
- ğŸ¨ è‡ªå®šä¹‰é¢œè‰²æ¸å˜
- ğŸ“ˆ è‡ªåŠ¨ç¼©æ”¾çƒ­åŠ›èŒƒå›´ï¼ˆAuto-Scalingï¼‰
- ğŸ’¬ é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæ•°å€¼ Tooltip
- ğŸ“Š æ”¯æŒå›¾ä¾‹æ  Legend
- ğŸ“± å“åº”å¼ç¼©æ”¾ï¼Œé€‚é…å¤šç§è®¾å¤‡å±å¹•
- ğŸ›¡ï¸ é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€æ˜¾ç¤º

---

## ğŸ§¾ é…ç½®ç¤ºä¾‹ï¼ˆYAMLï¼‰

```yaml
type: custom:heatmap-card
background: /local/house.svg  # å¿…éœ€
width: 400                    # å¯é€‰ï¼Œé»˜è®¤è‡ªé€‚åº”
height: 300                   # å¯é€‰ï¼Œé»˜è®¤è‡ªé€‚åº”
radius: 45                    # å¯é€‰ï¼Œé»˜è®¤40
blur: 0.9                     # å¯é€‰ï¼Œé»˜è®¤0.85
auto_scale: true              # å¯é€‰ï¼Œé»˜è®¤false
scale_margin: 5               # å¯é€‰ï¼Œé»˜è®¤0
update_interval: 10           # å¯é€‰ï¼Œé»˜è®¤30ç§’
min_value: 0                  # å¯é€‰ï¼Œæ‰‹åŠ¨è®¾ç½®æœ€å°å€¼
max_value: 100                # å¯é€‰ï¼Œæ‰‹åŠ¨è®¾ç½®æœ€å¤§å€¼
opacity: 0.8                  # å¯é€‰ï¼Œçƒ­åŠ›å›¾é€æ˜åº¦
gradient:                     # å¯é€‰ï¼Œé»˜è®¤è“->ç»¿->çº¢
  0.0: "#00f"
  0.5: "#0f0"
  1.0: "#f00"
show_legend: true             # å¯é€‰ï¼Œé»˜è®¤false
legend_position: bottom       # å¯é€‰ï¼Œé»˜è®¤right
legend_unit: "Â°C"            # å¯é€‰
show_labels: false            # å¯é€‰ï¼Œæ˜¯å¦æ˜¾ç¤ºæ ‡ç­¾
error_message: "ä¼ æ„Ÿå™¨æ•°æ®è·å–å¤±è´¥"  # å¯é€‰ï¼Œè‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯
points:                       # å¿…éœ€ï¼Œè‡³å°‘ä¸€ä¸ªç‚¹
  - x: 120                    # å¿…éœ€
    y: 100                    # å¿…éœ€
    entity_id: sensor.temp_living  # entity_idå’ŒvalueäºŒé€‰ä¸€
    label: "Living Room"      # å¯é€‰
  - x: 320
    y: 280
    value: 25.5               # é™æ€å€¼
    label: "Kitchen"
```

---

## âš™ï¸ é…ç½®å­—æ®µè¯¦ç»†è¯´æ˜

### ğŸ–¼ï¸ åŸºç¡€é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | æè¿° |
|--------------------|----------|------|-------|------|
| `background`        | string   | âœ…   | -     | èƒŒæ™¯å›¾è·¯å¾„ï¼Œæ”¯æŒæœ¬åœ°è·¯å¾„æˆ–URL |
| `width`             | number   | âŒ   | auto  | å¡ç‰‡å®½åº¦ï¼ˆåƒç´ ï¼‰ |
| `height`            | number   | âŒ   | auto  | å¡ç‰‡é«˜åº¦ï¼ˆåƒç´ ï¼‰ |

### ğŸ”¥ çƒ­åŠ›å›¾é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | éªŒè¯è§„åˆ™ | æè¿° |
|--------------------|----------|------|-------|----------|------|
| `radius`            | number   | âŒ   | 40    | 10-100   | çƒ­åŠ›ç‚¹åŠå¾„ï¼ˆåƒç´ ï¼‰ |
| `blur`              | number   | âŒ   | 0.85  | 0-1      | æ¨¡ç³Šç¨‹åº¦ |
| `opacity`           | number   | âŒ   | 0.6   | 0-1      | çƒ­åŠ›å›¾é€æ˜åº¦ |
| `max_value`         | number   | âŒ   | -     | > 0      | æ‰‹åŠ¨è®¾ç½®æœ€å¤§å€¼ |
| `min_value`         | number   | âŒ   | -     | â‰¥ 0      | æ‰‹åŠ¨è®¾ç½®æœ€å°å€¼ |

### ğŸ“Š ç¼©æ”¾é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | æè¿° |
|--------------------|----------|------|-------|------|
| `auto_scale`        | boolean  | âŒ   | false | è‡ªåŠ¨ç¼©æ”¾çƒ­åŠ›å›¾å€¼åŸŸ |
| `scale_margin`      | number   | âŒ   | 0     | ç¼©æ”¾ä½™é‡ç™¾åˆ†æ¯”ï¼ˆ0-50ï¼‰ |

### ğŸ”„ æ›´æ–°é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | éªŒè¯è§„åˆ™ | æè¿° |
|--------------------|----------|------|-------|----------|------|
| `update_interval`   | number   | âŒ   | 30    | 5-3600   | æ›´æ–°é¢‘ç‡ï¼ˆç§’ï¼‰ |

### ğŸ¨ æ ·å¼é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | æè¿° |
|--------------------|----------|------|-------|------|
| `gradient`          | object   | âŒ   | é»˜è®¤æ¸å˜ | é¢œè‰²æ¸å˜æ˜ å°„ |

### ğŸ“ˆ å›¾ä¾‹é…ç½®
| é…ç½®é¡¹             | ç±»å‹     | å¿…éœ€ | é»˜è®¤å€¼ | å¯é€‰å€¼ | æè¿° |
|--------------------|----------|------|-------|-------|------|
| `show_legend`       | boolean  | âŒ   | false | -     | æ˜¯å¦æ˜¾ç¤ºå›¾ä¾‹ |
| `legend_position`   | string   | âŒ   | right | top/bottom/left/right | å›¾ä¾‹ä½ç½® |
| `legend_unit`       | string   | âŒ   | ""    | -     | å›¾ä¾‹å•ä½æ–‡å­— |

### ğŸ”¥ çƒ­åŠ›ç‚¹é…ç½®
```yaml
points:  # æ•°ç»„ï¼Œå¿…éœ€è‡³å°‘ä¸€ä¸ªå…ƒç´ 
  - x: number          # å¿…éœ€ï¼Œ0-èƒŒæ™¯å›¾å®½åº¦
    y: number          # å¿…éœ€ï¼Œ0-èƒŒæ™¯å›¾é«˜åº¦  
    entity_id: string  # å¯é€‰ï¼ŒHAå®ä½“ID
    value: number      # å¯é€‰ï¼Œé™æ€å€¼
    label: string      # å¯é€‰ï¼Œæ‚¬åœæ ‡ç­¾
    weight: number     # å¯é€‰ï¼Œæƒé‡(0.1-2.0)ï¼Œé»˜è®¤1.0
```

---

## ğŸ›¡ï¸ é”™è¯¯å¤„ç†å’ŒéªŒè¯

### é…ç½®éªŒè¯è§„åˆ™
- `background` å¿…éœ€ä¸”ä¸èƒ½ä¸ºç©º
- `points` å¿…éœ€ä¸”è‡³å°‘åŒ…å«ä¸€ä¸ªæœ‰æ•ˆç‚¹
- æ¯ä¸ªç‚¹å¿…é¡»æœ‰ `entity_id` æˆ– `value` å…¶ä¸­ä¹‹ä¸€
- æ•°å€¼å­—æ®µéœ€è¦åœ¨æœ‰æ•ˆèŒƒå›´å†…

### é”™è¯¯çŠ¶æ€å¤„ç†
1. **é…ç½®é”™è¯¯**ï¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œé˜»æ­¢æ¸²æŸ“
2. **èƒŒæ™¯å›¾åŠ è½½å¤±è´¥**ï¼šæ˜¾ç¤ºå ä½ç¬¦å’Œé”™è¯¯æç¤º
3. **ä¼ æ„Ÿå™¨ç¦»çº¿/æ— æ•ˆ**ï¼šåœ¨è¯¥ç‚¹æ˜¾ç¤ºç°è‰²æˆ–é—®å·
4. **ç½‘ç»œé”™è¯¯**ï¼šæ˜¾ç¤ºé‡è¯•æŒ‰é’®

### åŠ è½½çŠ¶æ€
- èƒŒæ™¯å›¾åŠ è½½æ—¶æ˜¾ç¤ºéª¨æ¶å±
- æ•°æ®è·å–æ—¶æ˜¾ç¤ºloadingåŠ¨ç”»
- é¦–æ¬¡åŠ è½½å®Œæˆåæ·¡å…¥åŠ¨ç”»

---

## ğŸ”§ æŠ€æœ¯è¦æ±‚

### å…¼å®¹æ€§
- Home Assistant 2021.12+ 
- ç°ä»£æµè§ˆå™¨ï¼ˆChrome 88+, Firefox 85+, Safari 14+ï¼‰
- ç§»åŠ¨ç«¯å“åº”å¼æ”¯æŒ

### ä¾èµ–åº“
- heatmap.js 2.0+
- lit-elementï¼ˆéµå¾ª HA æ ‡å‡†ï¼‰

### æ€§èƒ½è¦æ±‚
- æ”¯æŒæœ€å¤š100ä¸ªçƒ­åŠ›ç‚¹
- æ›´æ–°é¢‘ç‡æœ€é«˜æ¯5ç§’ä¸€æ¬¡
- å†…å­˜ä½¿ç”¨ < 50MB

---

## ğŸ§ª æ›´æ–°é€»è¾‘è¯´æ˜

### è‡ªåŠ¨æ›´æ–°æµç¨‹
1. åˆå§‹åŒ–æ—¶è®¢é˜…æ‰€æœ‰å®ä½“çŠ¶æ€å˜åŒ–
2. æ¯ `update_interval` ç§’æˆ–å®ä½“çŠ¶æ€å˜åŒ–æ—¶è§¦å‘æ›´æ–°
3. æ‰¹é‡è·å–æ‰€æœ‰å®ä½“å½“å‰å€¼
4. åº”ç”¨è‡ªåŠ¨ç¼©æ”¾ï¼ˆå¦‚å¯ç”¨ï¼‰
5. é‡æ–°æ¸²æŸ“çƒ­åŠ›å›¾

### æ‰‹åŠ¨æ›´æ–°
- æ”¯æŒé€šè¿‡ HA æœåŠ¡è°ƒç”¨æ‰‹åŠ¨åˆ·æ–°
- å¡ç‰‡é…ç½®æ›´æ”¹æ—¶è‡ªåŠ¨é‡æ–°åˆå§‹åŒ–

---

## ğŸ“Š å›¾ä¾‹ï¼ˆLegendï¼‰

### æ˜¾ç¤ºé€»è¾‘
- `show_legend: true` æ—¶æ˜¾ç¤º
- è‡ªåŠ¨è®¡ç®—å½“å‰æ•°å€¼èŒƒå›´
- æ˜¾ç¤ºé¢œè‰²æ¡å’Œå¯¹åº”æ•°å€¼
- åŒ…å«å•ä½ä¿¡æ¯

### æ ·å¼
- æ”¯æŒ4ä¸ªæ–¹å‘å¸ƒå±€
- è‡ªé€‚åº”å®¹å™¨å¤§å°
- å¯è‡ªå®šä¹‰æ ·å¼

---

## ğŸ§  è‡ªåŠ¨ç¼©æ”¾ç®—æ³•

```typescript
// å¯ç”¨auto_scaleæ—¶
const values = points.map(p => getCurrentValue(p));
const min = Math.min(...values);
const max = Math.max(...values);
const margin = (max - min) * (scale_margin / 100);

const adjustedMin = min - margin;
const adjustedMax = max + margin;

// å½’ä¸€åŒ–
const normalizedValue = (value - adjustedMin) / (adjustedMax - adjustedMin);
```

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½æµ‹è¯•
- [ ] é…ç½®è§£ææ­£ç¡®
- [ ] èƒŒæ™¯å›¾æ­£å¸¸æ˜¾ç¤º
- [ ] çƒ­åŠ›å›¾æ¸²æŸ“æ­£ç¡®
- [ ] å®ä½“æ•°æ®ç»‘å®šæœ‰æ•ˆ
- [ ] è‡ªåŠ¨æ›´æ–°å·¥ä½œæ­£å¸¸
- [ ] äº¤äº’åŠŸèƒ½å®Œæ•´

### æ€§èƒ½æµ‹è¯•  
- [ ] 50ä¸ªç‚¹ä½æ—¶æ›´æ–°å»¶è¿Ÿ < 100ms
- [ ] å†…å­˜ä½¿ç”¨ç¨³å®šï¼Œæ— æ³„æ¼
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸

### å…¼å®¹æ€§æµ‹è¯•
- [ ] å„æµè§ˆå™¨æ˜¾ç¤ºä¸€è‡´
- [ ] ç§»åŠ¨ç«¯æ“ä½œæµç•…
- [ ] HAä¸åŒç‰ˆæœ¬å…¼å®¹

---

## ğŸ”® åç»­æ‰©å±•åŠŸèƒ½ï¼ˆV2ï¼‰

| ä¼˜å…ˆçº§ | åŠŸèƒ½                     | æè¿° |
|-------|--------------------------|------|
| é«˜     | æ”¯æŒç‚¹å‡»äº¤äº’             | ç‚¹å‡»çƒ­åŠ›ç‚¹æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ |
| é«˜     | UIé…ç½®å™¨               | å¯è§†åŒ–é…ç½®ç•Œé¢ |
| ä¸­     | åŠ¨ç”»è¿‡æ¸¡                 | æ•°å€¼å˜åŒ–æ—¶çš„å¹³æ»‘åŠ¨ç”» |
| ä¸­     | æ”¯æŒä¼ æ„Ÿå™¨é€šé…ç¬¦         | sensor.room_* æ‰¹é‡åŒ¹é… |
| ä½     | æ”¯æŒå¤šä¸ªå›¾å±‚             | æ¸©åº¦ + æ¹¿åº¦å åŠ æ˜¾ç¤º |
| ä½     | å†å²æ•°æ®æ”¯æŒ             | æ˜¾ç¤ºå†å²è¶‹åŠ¿ |

---

## ğŸ“¦ äº¤ä»˜ç‰©

### å¼€å‘é˜¶æ®µ
- æºä»£ç ï¼ˆTypeScript + Lit Elementï¼‰
- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•ç”¨ä¾‹
- å¼€å‘æ–‡æ¡£

### å‘å¸ƒé˜¶æ®µ  
- `heatmap-card.js` (ç¼–è¯‘å)
- `README.md` (å®‰è£…å’Œä½¿ç”¨è¯´æ˜)
- `hacs.json` (HACSé›†æˆé…ç½®)
- ç¤ºä¾‹é…ç½®æ–‡ä»¶
- æ›´æ–°æ—¥å¿—

---

## ğŸ“œ è®¸å¯è¯

MIT License
```

## ğŸ¯ ä¸»è¦æ”¹è¿›ç‚¹æ€»ç»“

1. **å¢åŠ äº†è¯¦ç»†çš„å­—æ®µéªŒè¯è§„åˆ™å’Œé»˜è®¤å€¼**
2. **è¡¥å……äº†é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€è¯´æ˜** 
3. **æ˜ç¡®äº†æŠ€æœ¯è¦æ±‚å’Œå…¼å®¹æ€§æ ‡å‡†**
4. **å¢åŠ äº†æ€§èƒ½è¦æ±‚å’Œé™åˆ¶**
5. **è¡¥å……äº†éªŒæ”¶æ ‡å‡†å’Œæµ‹è¯•è¦æ±‚**
6. **å®Œå–„äº†äº¤ä»˜ç‰©æ¸…å•**
7. **ä¼˜åŒ–äº†é…ç½®å­—æ®µçš„ç»„ç»‡ç»“æ„**
8. **å¢åŠ äº†æ›´å¤šå®ç”¨çš„é…ç½®é€‰é¡¹**

è¿™æ ·çš„éœ€æ±‚æ–‡æ¡£æ›´åŠ å®Œæ•´å’Œå¯æ‰§è¡Œï¼Œèƒ½å¤ŸæŒ‡å¯¼å¼€å‘å›¢é˜Ÿè¿›è¡Œå…·ä½“çš„å®ç°å·¥ä½œã€‚

